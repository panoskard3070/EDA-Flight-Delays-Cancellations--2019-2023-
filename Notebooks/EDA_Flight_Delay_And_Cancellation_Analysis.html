<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>4422aaf71fa14c81900a1d53e8093923</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="KYiPNm8RniBv">
<p>#<strong>Flight Delay and Cancellation Analysis from 2.9 Million
Flights (EDA)</strong></p>
<p><strong>Author:</strong>
<code>Panagiotis Kardatos, Mathematician</code></p>
<p><strong>Date:</strong> <code>Late October 2025</code></p>
<p>The main objective of this data analysis is to explore patterns in
flight delays and cancellations between 2019-2023. We are focusing
on:</p>
<ul>
<li>How delays evolved over time</li>
<li>Which airlines and airports have the highest delay or cancellation
rates</li>
<li>Time periods most associated with delays</li>
</ul>
</div>
<div class="cell markdown" id="9u08_dzCqCj4">
<p>##<strong>Step 1: Data Import and Setup</strong> At this step:</p>
<ul>
<li><p>We will install and import all the libraries required for this
project.</p></li>
<li><p>We will download data and get them into chunks due to the extreme
size of this dataset.</p></li>
</ul>
</div>
<div class="cell markdown" id="DLgMXlB8r03a">
<p>We begin by installing <code>kagglehub</code> to get access and
download the dataset directly and <code>cudf</code> a GPU dataframe
library to utilize high computational GPU speeds where is possible then
we will import the libraries.</p>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZWyT_riRrZ_T" data-outputId="3b47ede3-39c4-47df-9f7c-00993aff161b">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Libraries Installation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install kagglehub</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install cudf<span class="op">-</span>cu12 <span class="op">--</span>extra<span class="op">-</span>index<span class="op">-</span>url<span class="op">=</span>https:<span class="op">//</span>pypi.nvidia.com</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: kagglehub in /usr/local/lib/python3.12/dist-packages (0.3.13)
Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from kagglehub) (25.0)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from kagglehub) (6.0.3)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from kagglehub) (2.32.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from kagglehub) (4.67.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2025.10.5)
Looking in indexes: https://pypi.org/simple, https://pypi.nvidia.com
Requirement already satisfied: cudf-cu12 in /usr/local/lib/python3.12/dist-packages (25.6.0)
Requirement already satisfied: cachetools in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (5.5.2)
Requirement already satisfied: cuda-python&lt;13.0a0,&gt;=12.6.2 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.6.2.post1)
Requirement already satisfied: cupy-cuda12x&gt;=12.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (13.3.0)
Requirement already satisfied: fsspec&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2025.3.0)
Requirement already satisfied: libcudf-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: numba-cuda&lt;0.12.0a0,&gt;=0.11.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.11.0)
Requirement already satisfied: numba&lt;0.62.0a0,&gt;=0.59.1 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.60.0)
Requirement already satisfied: numpy&lt;3.0a0,&gt;=1.23 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2.0.2)
Requirement already satisfied: nvidia-cuda-nvcc-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.5.82)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.6.77)
Requirement already satisfied: nvtx&gt;=0.2.1 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.2.13)
Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.0)
Requirement already satisfied: pandas&lt;2.2.4dev0,&gt;=2.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2.2.2)
Requirement already satisfied: pyarrow&lt;20.0.0a0,&gt;=14.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (18.1.0)
Requirement already satisfied: pylibcudf-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: pynvjitlink-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.7.0)
Requirement already satisfied: rich in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (13.9.4)
Requirement already satisfied: rmm-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: typing_extensions&gt;=4.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (4.15.0)
Requirement already satisfied: libkvikio-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (25.6.0)
Requirement already satisfied: librmm-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (25.6.0)
Requirement already satisfied: rapids-logger==0.1.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (0.1.19)
Requirement already satisfied: fastrlock&gt;=0.5 in /usr/local/lib/python3.12/dist-packages (from cupy-cuda12x&gt;=12.0.0-&gt;cudf-cu12) (0.8.3)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba&lt;0.62.0a0,&gt;=0.59.1-&gt;cudf-cu12) (0.43.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2025.2)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich-&gt;cudf-cu12) (4.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich-&gt;cudf-cu12) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;cudf-cu12) (0.1.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (1.17.0)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="gHEw5QiXtoOy" data-outputId="1e55a064-d6d4-4529-d8f9-4f8fb1434e9f">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing Required Libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#For General Use</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#For my kagglehub credentials</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> userdata</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#For Data Importation</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> kagglehub</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#For Plots</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#For GPU \ Dataframes</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext cudf.pandas</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/utils/gpu_utils.py:75: UserWarning: Failed to dlopen libcuda.so.1
  warnings.warn(str(e))
/usr/local/lib/python3.12/dist-packages/cudf/pandas/__init__.py:64: UserWarning: Function &quot;cuInit&quot; not found
  warnings.warn(str(e))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3" id="ZyDMDOTJwX1M">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Kagglehub Login</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;KAGGLEHUB_USERNAME&#39;</span>]<span class="op">=</span>userdata.get(<span class="st">&#39;user&#39;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;KAGGLEHUB_KEY&#39;</span>]<span class="op">=</span>userdata.get(<span class="st">&#39;key&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="YvnF5gz3xQkT" data-outputId="9f65c103-f346-4ce5-d44a-82eb2010f90c">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data Download</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>file_path<span class="op">=</span>kagglehub.dataset_download(<span class="st">&quot;patrickzel/flight-delay-and-cancellation-dataset-2019-2023&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(file_path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Using Colab cache for faster access to the &#39;flight-delay-and-cancellation-dataset-2019-2023&#39; dataset.
/kaggle/input/flight-delay-and-cancellation-dataset-2019-2023
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="N1mz3QNtzCLS" data-outputId="a65ea4b1-8784-4403-9384-b1a2819ee693">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Full File Path</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>path<span class="op">=</span>os.path.join(file_path,<span class="st">&#39;flights_sample_3m.csv&#39;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>/kaggle/input/flight-delay-and-cancellation-dataset-2019-2023/flights_sample_3m.csv
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6" id="15L6OHQ_zmks">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Chunks as a fully loaded dataset can crash the system</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>chunker<span class="op">=</span>pd.read_csv(path, chunksize<span class="op">=</span><span class="dv">1000000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7" id="JKFg_z9SaKgw">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading the first DataFrame into memory</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span><span class="bu">next</span>(chunker)</span></code></pre></div>
</div>
<div class="cell markdown" id="DR70xC9Yabc4">
<p>##<strong>Step 2: Data Inspection</strong> At this step we will:</p>
<ul>
<li>Get a first view of our dataset</li>
<li>View the shape and gather some main information</li>
<li>Seek out for any Missing Values</li>
</ul>
<p>We must not forget that we are working in chunks. This means that in
every section we will make some experiments with the already loaded in
memory datafarame, then the results of theese experiments will be
modeled in a defined function and apply them all together later in Step
5.</p>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:446}"
id="T4fc0nHAaWz2" data-outputId="8e1f2be2-fad9-4e24-a327-e58ec97e8f19">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Head</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FL_DATE</th>
      <th>AIRLINE</th>
      <th>AIRLINE_DOT</th>
      <th>AIRLINE_CODE</th>
      <th>DOT_CODE</th>
      <th>FL_NUMBER</th>
      <th>ORIGIN</th>
      <th>ORIGIN_CITY</th>
      <th>DEST</th>
      <th>DEST_CITY</th>
      <th>...</th>
      <th>DIVERTED</th>
      <th>CRS_ELAPSED_TIME</th>
      <th>ELAPSED_TIME</th>
      <th>AIR_TIME</th>
      <th>DISTANCE</th>
      <th>DELAY_DUE_CARRIER</th>
      <th>DELAY_DUE_WEATHER</th>
      <th>DELAY_DUE_NAS</th>
      <th>DELAY_DUE_SECURITY</th>
      <th>DELAY_DUE_LATE_AIRCRAFT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-09</td>
      <td>United Air Lines Inc.</td>
      <td>United Air Lines Inc.: UA</td>
      <td>UA</td>
      <td>19977</td>
      <td>1562</td>
      <td>FLL</td>
      <td>Fort Lauderdale, FL</td>
      <td>EWR</td>
      <td>Newark, NJ</td>
      <td>...</td>
      <td>0.0</td>
      <td>186.0</td>
      <td>176.0</td>
      <td>153.0</td>
      <td>1065.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-11-19</td>
      <td>Delta Air Lines Inc.</td>
      <td>Delta Air Lines Inc.: DL</td>
      <td>DL</td>
      <td>19790</td>
      <td>1149</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>SEA</td>
      <td>Seattle, WA</td>
      <td>...</td>
      <td>0.0</td>
      <td>235.0</td>
      <td>236.0</td>
      <td>189.0</td>
      <td>1399.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-07-22</td>
      <td>United Air Lines Inc.</td>
      <td>United Air Lines Inc.: UA</td>
      <td>UA</td>
      <td>19977</td>
      <td>459</td>
      <td>DEN</td>
      <td>Denver, CO</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>...</td>
      <td>0.0</td>
      <td>118.0</td>
      <td>112.0</td>
      <td>87.0</td>
      <td>680.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2023-03-06</td>
      <td>Delta Air Lines Inc.</td>
      <td>Delta Air Lines Inc.: DL</td>
      <td>DL</td>
      <td>19790</td>
      <td>2295</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>SFO</td>
      <td>San Francisco, CA</td>
      <td>...</td>
      <td>0.0</td>
      <td>260.0</td>
      <td>285.0</td>
      <td>249.0</td>
      <td>1589.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-02-23</td>
      <td>Spirit Air Lines</td>
      <td>Spirit Air Lines: NK</td>
      <td>NK</td>
      <td>20416</td>
      <td>407</td>
      <td>MCO</td>
      <td>Orlando, FL</td>
      <td>DFW</td>
      <td>Dallas/Fort Worth, TX</td>
      <td>...</td>
      <td>0.0</td>
      <td>181.0</td>
      <td>182.0</td>
      <td>153.0</td>
      <td>985.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 32 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="e9VEk-QneGlg" data-outputId="1479bd51-c136-47bd-f3a7-f6befd169edb">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Info, Shape</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df<span class="sc">.</span>info()<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">Shape:</span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 32 columns):
 #   Column                   Non-Null Count    Dtype  
---  ------                   --------------    -----  
 0   FL_DATE                  1000000 non-null  object 
 1   AIRLINE                  1000000 non-null  object 
 2   AIRLINE_DOT              1000000 non-null  object 
 3   AIRLINE_CODE             1000000 non-null  object 
 4   DOT_CODE                 1000000 non-null  int64  
 5   FL_NUMBER                1000000 non-null  int64  
 6   ORIGIN                   1000000 non-null  object 
 7   ORIGIN_CITY              1000000 non-null  object 
 8   DEST                     1000000 non-null  object 
 9   DEST_CITY                1000000 non-null  object 
 10  CRS_DEP_TIME             1000000 non-null  int64  
 11  DEP_TIME                 974161 non-null   float64
 12  DEP_DELAY                974153 non-null   float64
 13  TAXI_OUT                 973760 non-null   float64
 14  WHEELS_OFF               973760 non-null   float64
 15  WHEELS_ON                973384 non-null   float64
 16  TAXI_IN                  973384 non-null   float64
 17  CRS_ARR_TIME             1000000 non-null  int64  
 18  ARR_TIME                 973384 non-null   float64
 19  ARR_DELAY                971340 non-null   float64
 20  CANCELLED                1000000 non-null  float64
 21  CANCELLATION_CODE        26355 non-null    object 
 22  DIVERTED                 1000000 non-null  float64
 23  CRS_ELAPSED_TIME         999993 non-null   float64
 24  ELAPSED_TIME             971340 non-null   float64
 25  AIR_TIME                 971340 non-null   float64
 26  DISTANCE                 1000000 non-null  float64
 27  DELAY_DUE_CARRIER        178517 non-null   float64
 28  DELAY_DUE_WEATHER        178517 non-null   float64
 29  DELAY_DUE_NAS            178517 non-null   float64
 30  DELAY_DUE_SECURITY       178517 non-null   float64
 31  DELAY_DUE_LATE_AIRCRAFT  178517 non-null   float64
dtypes: float64(19), int64(4), object(9)
memory usage: 244.1+ MB
None 
 
Shape:(1000000, 32)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="olv5mDrrembY" data-outputId="cb5dafbf-82a9-4022-d0ac-2d891bf9ddc7">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Missing Values per Column</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>FL_DATE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AIRLINE_DOT</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AIRLINE_CODE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DOT_CODE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>FL_NUMBER</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ORIGIN</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ORIGIN_CITY</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEST</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEST_CITY</th>
      <td>0</td>
    </tr>
    <tr>
      <th>CRS_DEP_TIME</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEP_TIME</th>
      <td>25839</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>25847</td>
    </tr>
    <tr>
      <th>TAXI_OUT</th>
      <td>26240</td>
    </tr>
    <tr>
      <th>WHEELS_OFF</th>
      <td>26240</td>
    </tr>
    <tr>
      <th>WHEELS_ON</th>
      <td>26616</td>
    </tr>
    <tr>
      <th>TAXI_IN</th>
      <td>26616</td>
    </tr>
    <tr>
      <th>CRS_ARR_TIME</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ARR_TIME</th>
      <td>26616</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>0</td>
    </tr>
    <tr>
      <th>CANCELLATION_CODE</th>
      <td>973645</td>
    </tr>
    <tr>
      <th>DIVERTED</th>
      <td>0</td>
    </tr>
    <tr>
      <th>CRS_ELAPSED_TIME</th>
      <td>7</td>
    </tr>
    <tr>
      <th>ELAPSED_TIME</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>DISTANCE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DELAY_DUE_CARRIER</th>
      <td>821483</td>
    </tr>
    <tr>
      <th>DELAY_DUE_WEATHER</th>
      <td>821483</td>
    </tr>
    <tr>
      <th>DELAY_DUE_NAS</th>
      <td>821483</td>
    </tr>
    <tr>
      <th>DELAY_DUE_SECURITY</th>
      <td>821483</td>
    </tr>
    <tr>
      <th>DELAY_DUE_LATE_AIRCRAFT</th>
      <td>821483</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="W60Jm0tQgeL-">
<p>##<strong>Step 3: Data Cleaning</strong> At this step we will:</p>
<ul>
<li>Drop Columns not necessarry for the analysis</li>
<li>Ensure we have the correct data type</li>
<li>We will manipulate any missing data</li>
<li>Remove Duplicate Entries</li>
<li>Define the first cleaning function for chunker</li>
</ul>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="n0q3rTooi3sK" data-outputId="94801482-2300-47ad-e11c-bfc4f60ff3fc">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping Columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">&#39;AIRLINE_DOT&#39;</span>,<span class="st">&#39;AIRLINE_CODE&#39;</span>,<span class="st">&#39;DOT_CODE&#39;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;CANCELLATION_CODE&#39;</span>,<span class="st">&#39;DIVERTED&#39;</span>,<span class="st">&#39;TAXI_OUT&#39;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;WHEELS_OFF&#39;</span>,<span class="st">&#39;WHEELS_ON&#39;</span>,<span class="st">&#39;TAXI_IN&#39;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;CANCELLATION_CODE&#39;</span>,<span class="st">&#39;DELAY_DUE_CARRIER&#39;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;DELAY_DUE_WEATHER&#39;</span>,<span class="st">&#39;DELAY_DUE_NAS&#39;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;DELAY_DUE_SECURITY&#39;</span>,<span class="st">&#39;DELAY_DUE_LATE_AIRCRAFT&#39;</span>, <span class="st">&#39;CRS_ELAPSED_TIME&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FL_DATE</th>
      <th>AIRLINE</th>
      <th>FL_NUMBER</th>
      <th>ORIGIN</th>
      <th>ORIGIN_CITY</th>
      <th>DEST</th>
      <th>DEST_CITY</th>
      <th>CRS_DEP_TIME</th>
      <th>DEP_TIME</th>
      <th>DEP_DELAY</th>
      <th>CRS_ARR_TIME</th>
      <th>ARR_TIME</th>
      <th>ARR_DELAY</th>
      <th>CANCELLED</th>
      <th>ELAPSED_TIME</th>
      <th>AIR_TIME</th>
      <th>DISTANCE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-09</td>
      <td>United Air Lines Inc.</td>
      <td>1562</td>
      <td>FLL</td>
      <td>Fort Lauderdale, FL</td>
      <td>EWR</td>
      <td>Newark, NJ</td>
      <td>1155</td>
      <td>1151.0</td>
      <td>-4.0</td>
      <td>1501</td>
      <td>1447.0</td>
      <td>-14.0</td>
      <td>0.0</td>
      <td>176.0</td>
      <td>153.0</td>
      <td>1065.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-11-19</td>
      <td>Delta Air Lines Inc.</td>
      <td>1149</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>SEA</td>
      <td>Seattle, WA</td>
      <td>2120</td>
      <td>2114.0</td>
      <td>-6.0</td>
      <td>2315</td>
      <td>2310.0</td>
      <td>-5.0</td>
      <td>0.0</td>
      <td>236.0</td>
      <td>189.0</td>
      <td>1399.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-07-22</td>
      <td>United Air Lines Inc.</td>
      <td>459</td>
      <td>DEN</td>
      <td>Denver, CO</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>954</td>
      <td>1000.0</td>
      <td>6.0</td>
      <td>1252</td>
      <td>1252.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>112.0</td>
      <td>87.0</td>
      <td>680.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2023-03-06</td>
      <td>Delta Air Lines Inc.</td>
      <td>2295</td>
      <td>MSP</td>
      <td>Minneapolis, MN</td>
      <td>SFO</td>
      <td>San Francisco, CA</td>
      <td>1609</td>
      <td>1608.0</td>
      <td>-1.0</td>
      <td>1829</td>
      <td>1853.0</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>285.0</td>
      <td>249.0</td>
      <td>1589.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-02-23</td>
      <td>Spirit Air Lines</td>
      <td>407</td>
      <td>MCO</td>
      <td>Orlando, FL</td>
      <td>DFW</td>
      <td>Dallas/Fort Worth, TX</td>
      <td>1840</td>
      <td>1838.0</td>
      <td>-2.0</td>
      <td>2041</td>
      <td>2040.0</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>182.0</td>
      <td>153.0</td>
      <td>985.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:617}"
id="a1SsgR63i3xp" data-outputId="175c96ff-09b2-4509-811c-fa4acc84fca0">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data Types</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>FL_DATE</th>
      <td>object</td>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <td>object</td>
    </tr>
    <tr>
      <th>FL_NUMBER</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>ORIGIN</th>
      <td>object</td>
    </tr>
    <tr>
      <th>ORIGIN_CITY</th>
      <td>object</td>
    </tr>
    <tr>
      <th>DEST</th>
      <td>object</td>
    </tr>
    <tr>
      <th>DEST_CITY</th>
      <td>object</td>
    </tr>
    <tr>
      <th>CRS_DEP_TIME</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>DEP_TIME</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>CRS_ARR_TIME</th>
      <td>int64</td>
    </tr>
    <tr>
      <th>ARR_TIME</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>ELAPSED_TIME</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>float64</td>
    </tr>
    <tr>
      <th>DISTANCE</th>
      <td>float64</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> object</label>
</div>
</div>
<div class="cell code" data-execution_count="13" id="ZP-H4Qz0U8Va">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Type Conversion</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;CANCELLED&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;CANCELLED&#39;</span>].astype(<span class="st">&#39;bool&#39;</span>) <span class="co">#For filtering</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;FL_DATE&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;FL_DATE&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>) <span class="co">#For handling</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:617}"
id="wiwGQ6keWs3R" data-outputId="580f5206-f065-498a-f7a0-75ef8bb9825e">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Missing Data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>FL_DATE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <td>0</td>
    </tr>
    <tr>
      <th>FL_NUMBER</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ORIGIN</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ORIGIN_CITY</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEST</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEST_CITY</th>
      <td>0</td>
    </tr>
    <tr>
      <th>CRS_DEP_TIME</th>
      <td>0</td>
    </tr>
    <tr>
      <th>DEP_TIME</th>
      <td>25839</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>25847</td>
    </tr>
    <tr>
      <th>CRS_ARR_TIME</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ARR_TIME</th>
      <td>26616</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ELAPSED_TIME</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>28660</td>
    </tr>
    <tr>
      <th>DISTANCE</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="jetfh1_SZdW6">
<p>Before we continue we need pay attention to the number of flights
that were cancelled and and compare the result with the previous code
cell. Usually when the <code>DEP_DELAY</code> is NA means that flight
was cancelled.</p>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BJoe9npBYcUR" data-outputId="4a1367ac-46f7-447a-81ca-1995e9bf1d5d">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;CANCELLED&#39;</span>].<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<pre><code>np.int64(26355)</code></pre>
</div>
</div>
<div class="cell markdown" id="kWoRQqENhtAg">
<p>The deal now is to keep as many of theese 26355 (cancelled flights)
rows. If <code>DEP_DELAY</code> is NA then other time columns are NA as
well (except for <code>DEP_TIME</code> as an emergency can happen out of
nowhere)</p>
<ul>
<li>According to the previous we can pick columns <code>DEP_DELAY</code>
and <code>AIR_TIME</code> to find the intersection of common rows which
have NA's (result 1).</li>
<li>We will also find the intersection of non-NA <code>DEP_DELAY</code>
with non NA <code>AIR_TIME</code> (result 2).</li>
<li>Final result will be <strong>DataFrame[result1 or result2]</strong>
where 'or' is the boolean or.</li>
</ul>
<p>In other words let 𝛺 be a sample space, Α,Β subsets where Β⊂Α. The
subsets contain null values. Α is the <code>AIR_DELAY</code> and Β is
<code>DEP_DELAY</code>. The filtered dataframe can be evaluated by ( Α⋂Β
) ⋃ Αᶜ.</p>
</div>
<div class="cell code" data-execution_count="16" id="vMEjhszgrIEK">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtered Dataframe</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>(df[<span class="st">&#39;DEP_DELAY&#39;</span>].isnull() <span class="op">&amp;</span> df[<span class="st">&#39;AIR_TIME&#39;</span>].isnull())</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>(df[<span class="st">&#39;AIR_TIME&#39;</span>].notnull())</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df[a<span class="op">|</span>b].sort_values(by<span class="op">=</span><span class="st">&#39;FL_DATE&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#We are also sorting by date at the same step.</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BiEJcdNstrsr" data-outputId="866629cd-a7fd-4d3f-bf65-d69d928bb982">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplication Check</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;The number of duplicate rows are </span><span class="sc">{</span>df<span class="sc">.</span>duplicated()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>) <span class="co">#By resetting the DF is finally ready.</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>The number of duplicate rows are 0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18" id="wS5rmfisbl-n">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the cleaning function for chuncker:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_chunk(df):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Dropping Columns</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  df.drop(columns<span class="op">=</span>[<span class="st">&#39;AIRLINE_DOT&#39;</span>,<span class="st">&#39;AIRLINE_CODE&#39;</span>,<span class="st">&#39;DOT_CODE&#39;</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;CANCELLATION_CODE&#39;</span>,<span class="st">&#39;DIVERTED&#39;</span>,<span class="st">&#39;TAXI_OUT&#39;</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;WHEELS_OFF&#39;</span>,<span class="st">&#39;WHEELS_ON&#39;</span>,<span class="st">&#39;TAXI_IN&#39;</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;CANCELLATION_CODE&#39;</span>,<span class="st">&#39;DELAY_DUE_CARRIER&#39;</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;DELAY_DUE_WEATHER&#39;</span>,<span class="st">&#39;DELAY_DUE_NAS&#39;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;DELAY_DUE_SECURITY&#39;</span>,<span class="st">&#39;DELAY_DUE_LATE_AIRCRAFT&#39;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;CRS_ELAPSED_TIME&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Type Conversion</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;CANCELLED&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;CANCELLED&#39;</span>].astype(<span class="st">&#39;bool&#39;</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;FL_DATE&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;FL_DATE&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtered DataFrame</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  a<span class="op">=</span>(df[<span class="st">&#39;DEP_DELAY&#39;</span>].isnull() <span class="op">&amp;</span> df[<span class="st">&#39;AIR_TIME&#39;</span>].isnull())</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  b<span class="op">=</span>(df[<span class="st">&#39;AIR_TIME&#39;</span>].notnull())</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  df<span class="op">=</span>df[a<span class="op">|</span>b].sort_values(by<span class="op">=</span><span class="st">&#39;FL_DATE&#39;</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Duplication Check</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  df.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell markdown" id="1SLf_Y2qeTQb">
<p>##<strong>Step 4: Feature Engineering</strong> At this step we will
create useful features to enhance the analysis. The goal here is to
extract both numerical and categorical insights.</p>
<ul>
<li>Time Features</li>
<li>Time of Day Features</li>
<li>Time Bins</li>
<li>Delay Indications</li>
<li>Route</li>
</ul>
<p>As a last step we will define the feature engineering function for
chunker.</p>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="kcUamuoOiAXf" data-outputId="10ad959f-1666-4bbe-f2c7-46a1685cbfd2">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FL_DATE</th>
      <th>AIRLINE</th>
      <th>FL_NUMBER</th>
      <th>ORIGIN</th>
      <th>ORIGIN_CITY</th>
      <th>DEST</th>
      <th>DEST_CITY</th>
      <th>CRS_DEP_TIME</th>
      <th>DEP_TIME</th>
      <th>DEP_DELAY</th>
      <th>CRS_ARR_TIME</th>
      <th>ARR_TIME</th>
      <th>ARR_DELAY</th>
      <th>CANCELLED</th>
      <th>ELAPSED_TIME</th>
      <th>AIR_TIME</th>
      <th>DISTANCE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>Southwest Airlines Co.</td>
      <td>452</td>
      <td>PHX</td>
      <td>Phoenix, AZ</td>
      <td>BUF</td>
      <td>Buffalo, NY</td>
      <td>1055</td>
      <td>1046.0</td>
      <td>-9.0</td>
      <td>1655</td>
      <td>1617.0</td>
      <td>-38.0</td>
      <td>False</td>
      <td>211.0</td>
      <td>197.0</td>
      <td>1912.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-01</td>
      <td>Republic Airline</td>
      <td>4522</td>
      <td>PHL</td>
      <td>Philadelphia, PA</td>
      <td>RDU</td>
      <td>Raleigh/Durham, NC</td>
      <td>2120</td>
      <td>2114.0</td>
      <td>-6.0</td>
      <td>2259</td>
      <td>2236.0</td>
      <td>-23.0</td>
      <td>False</td>
      <td>82.0</td>
      <td>59.0</td>
      <td>337.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01</td>
      <td>ExpressJet Airlines LLC d/b/a aha!</td>
      <td>3993</td>
      <td>CHA</td>
      <td>Chattanooga, TN</td>
      <td>IAD</td>
      <td>Washington, DC</td>
      <td>1440</td>
      <td>1514.0</td>
      <td>34.0</td>
      <td>1625</td>
      <td>1647.0</td>
      <td>22.0</td>
      <td>False</td>
      <td>93.0</td>
      <td>67.0</td>
      <td>506.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01</td>
      <td>Southwest Airlines Co.</td>
      <td>2131</td>
      <td>MDW</td>
      <td>Chicago, IL</td>
      <td>DTW</td>
      <td>Detroit, MI</td>
      <td>655</td>
      <td>701.0</td>
      <td>6.0</td>
      <td>855</td>
      <td>851.0</td>
      <td>-4.0</td>
      <td>False</td>
      <td>50.0</td>
      <td>36.0</td>
      <td>228.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01</td>
      <td>United Air Lines Inc.</td>
      <td>549</td>
      <td>ORD</td>
      <td>Chicago, IL</td>
      <td>PDX</td>
      <td>Portland, OR</td>
      <td>1245</td>
      <td>1347.0</td>
      <td>62.0</td>
      <td>1521</td>
      <td>1611.0</td>
      <td>50.0</td>
      <td>False</td>
      <td>264.0</td>
      <td>245.0</td>
      <td>1739.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="20" id="FLffCMKpiAin">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time Features</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;YEAR&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.year</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;MONTH&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.month</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DAY&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.day</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DAY_OF_WEEK&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.day_of_week</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21" id="QvqAaMPsiAk-">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time of Day Features</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;HOUR&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;DEP_TIME&#39;</span>].fillna(<span class="dv">0</span>)<span class="op">//</span><span class="dv">100</span>).astype(<span class="st">&#39;int32&#39;</span>) <span class="co">#Filling to Ignore Error</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;DEP_TIME&#39;</span>].isna(),<span class="st">&#39;HOUR&#39;</span>]<span class="op">=</span>np.nan <span class="co">#Filling NaN at the corresponding rows</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Time Bins</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>bins<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;Night&#39;</span>,<span class="st">&#39;Morning&#39;</span>,<span class="st">&#39;Afternoon&#39;</span>,<span class="st">&#39;Evening&#39;</span>]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;TIME_OF_DAY&#39;</span>]<span class="op">=</span>pd.cut(df[<span class="st">&#39;HOUR&#39;</span>],bins<span class="op">=</span>bins,labels<span class="op">=</span>labels,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                         right<span class="op">=</span><span class="va">False</span>, include_lowest<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="MIEOMqGWpKXS" data-outputId="fbfd0f13-ffd9-4558-8554-278020ab1594">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Delay Indications</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;IS_DELAYED&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;ARR_DELAY&#39;</span>].fillna(<span class="dv">0</span>)<span class="op">&gt;</span><span class="dv">15</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;ARR_DELAY&#39;</span>].isna(),<span class="st">&#39;IS_DELAYED&#39;</span>]<span class="op">=</span>np.nan</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;IS_HEAVY_DELAYED&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;ARR_DELAY&#39;</span>]<span class="op">&gt;</span><span class="dv">60</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;ARR_DELAY&#39;</span>].isna(),<span class="st">&#39;IS_HEAVY_DELAYED&#39;</span>]<span class="op">=</span>np.nan</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23" id="KRXagaUetr3K">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Route</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;ROUTE&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;ORIGIN_CITY&#39;</span>]<span class="op">+</span><span class="st">&#39;-&#39;</span><span class="op">+</span>df[<span class="st">&#39;DEST_CITY&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="24" id="7baTnI8nuO78">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Feature Engineering Function for Chunker</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> feature_chunker(df):</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Time Features</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;YEAR&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.year</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;MONTH&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.month</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;DAY&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.day</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;DAY_OF_WEEK&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;FL_DATE&#39;</span>].dt.day_of_week</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Time of Day Features</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;HOUR&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;DEP_TIME&#39;</span>].fillna(<span class="dv">0</span>)<span class="op">//</span><span class="dv">100</span>).astype(<span class="st">&#39;int32&#39;</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  df.loc[df[<span class="st">&#39;DEP_TIME&#39;</span>].isna(),<span class="st">&#39;HOUR&#39;</span>]<span class="op">=</span>np.nan</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Time Bins</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  bins<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  labels<span class="op">=</span>[<span class="st">&#39;Night&#39;</span>,<span class="st">&#39;Morning&#39;</span>,<span class="st">&#39;Afternoon&#39;</span>,<span class="st">&#39;Evening&#39;</span>]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;TIME_OF_DAY&#39;</span>]<span class="op">=</span>pd.cut(df[<span class="st">&#39;HOUR&#39;</span>],bins<span class="op">=</span>bins,labels<span class="op">=</span>labels,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                         right<span class="op">=</span><span class="va">False</span>, include_lowest<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Delay Indication</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;IS_DELAYED&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;ARR_DELAY&#39;</span>].fillna(<span class="dv">0</span>)<span class="op">&gt;</span><span class="dv">15</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  df.loc[df[<span class="st">&#39;ARR_DELAY&#39;</span>].isna(),<span class="st">&#39;IS_DELAYED&#39;</span>]<span class="op">=</span>np.nan</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;IS_HEAVY_DELAYED&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;ARR_DELAY&#39;</span>]<span class="op">&gt;</span><span class="dv">60</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  df.loc[df[<span class="st">&#39;ARR_DELAY&#39;</span>].isna(),<span class="st">&#39;IS_HEAVY_DELAYED&#39;</span>]<span class="op">=</span>np.nan</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Route</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;ROUTE&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;ORIGIN_CITY&#39;</span>]<span class="op">+</span><span class="st">&#39;-&#39;</span><span class="op">+</span>df[<span class="st">&#39;DEST_CITY&#39;</span>]</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell markdown" id="Snw9-dVKrIZ4">
<p>##<strong>Step 5: Statistical Analysis</strong> At this step we
will:</p>
<ul>
<li>Find Outliers for <code>ARR_DELAY</code> column so we can filter the
dataset and keep away extreme values (this can also help for Machine
Learning Projects)</li>
<li>Perform Groupby Analysis</li>
</ul>
</div>
<div class="cell markdown" id="1Lk1iMkBvV19">
<p><strong>Outliers</strong></p>
</div>
<div class="cell code" data-execution_count="25" id="QFNRbipGsJHT">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers (Securing up to 95% of observations)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>adm <span class="op">=</span> df[<span class="st">&#39;ARR_DELAY&#39;</span>].mean() <span class="co">#Mean</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>ads <span class="op">=</span> df[<span class="st">&#39;ARR_DELAY&#39;</span>].std() <span class="co">#Standard Deviation</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df_filtered<span class="op">=</span>(df[df[<span class="st">&#39;ARR_DELAY&#39;</span>].between(adm<span class="op">-</span><span class="dv">2</span><span class="op">*</span>ads,adm<span class="op">+</span><span class="dv">2</span><span class="op">*</span>ads)]</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>             .reset_index(drop<span class="op">=</span><span class="va">True</span>)) <span class="co">#Filtered</span></span></code></pre></div>
</div>
<div class="cell markdown" id="q2xl_ieqxVPI">
<p><strong>GroupBy Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:340}"
id="x7Z9GUCvxpPM" data-outputId="6cc486d1-b19d-4ca8-87d0-a31f96088ef7">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="26">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FL_DATE</th>
      <th>AIRLINE</th>
      <th>FL_NUMBER</th>
      <th>ORIGIN</th>
      <th>ORIGIN_CITY</th>
      <th>DEST</th>
      <th>DEST_CITY</th>
      <th>CRS_DEP_TIME</th>
      <th>DEP_TIME</th>
      <th>DEP_DELAY</th>
      <th>...</th>
      <th>DISTANCE</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>DAY_OF_WEEK</th>
      <th>HOUR</th>
      <th>TIME_OF_DAY</th>
      <th>IS_DELAYED</th>
      <th>IS_HEAVY_DELAYED</th>
      <th>ROUTE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>Southwest Airlines Co.</td>
      <td>452</td>
      <td>PHX</td>
      <td>Phoenix, AZ</td>
      <td>BUF</td>
      <td>Buffalo, NY</td>
      <td>1055</td>
      <td>1046.0</td>
      <td>-9.0</td>
      <td>...</td>
      <td>1912.0</td>
      <td>2019</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>10.0</td>
      <td>Morning</td>
      <td>False</td>
      <td>False</td>
      <td>Phoenix, AZ-Buffalo, NY</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-01</td>
      <td>Republic Airline</td>
      <td>4522</td>
      <td>PHL</td>
      <td>Philadelphia, PA</td>
      <td>RDU</td>
      <td>Raleigh/Durham, NC</td>
      <td>2120</td>
      <td>2114.0</td>
      <td>-6.0</td>
      <td>...</td>
      <td>337.0</td>
      <td>2019</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>21.0</td>
      <td>Evening</td>
      <td>False</td>
      <td>False</td>
      <td>Philadelphia, PA-Raleigh/Durham, NC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01</td>
      <td>ExpressJet Airlines LLC d/b/a aha!</td>
      <td>3993</td>
      <td>CHA</td>
      <td>Chattanooga, TN</td>
      <td>IAD</td>
      <td>Washington, DC</td>
      <td>1440</td>
      <td>1514.0</td>
      <td>34.0</td>
      <td>...</td>
      <td>506.0</td>
      <td>2019</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>15.0</td>
      <td>Afternoon</td>
      <td>True</td>
      <td>False</td>
      <td>Chattanooga, TN-Washington, DC</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01</td>
      <td>Southwest Airlines Co.</td>
      <td>2131</td>
      <td>MDW</td>
      <td>Chicago, IL</td>
      <td>DTW</td>
      <td>Detroit, MI</td>
      <td>655</td>
      <td>701.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>228.0</td>
      <td>2019</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>7.0</td>
      <td>Morning</td>
      <td>False</td>
      <td>False</td>
      <td>Chicago, IL-Detroit, MI</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01</td>
      <td>United Air Lines Inc.</td>
      <td>549</td>
      <td>ORD</td>
      <td>Chicago, IL</td>
      <td>PDX</td>
      <td>Portland, OR</td>
      <td>1245</td>
      <td>1347.0</td>
      <td>62.0</td>
      <td>...</td>
      <td>1739.0</td>
      <td>2019</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>13.0</td>
      <td>Afternoon</td>
      <td>True</td>
      <td>False</td>
      <td>Chicago, IL-Portland, OR</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="27"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="Ei9jn53Jsouz" data-outputId="440c9357-8710-431b-bc5f-540e7b198f81">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Airline (Top 10)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;AIRLINE&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">10</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="27">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIRLINE</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Allegiant Air</td>
      <td>13.551579</td>
    </tr>
    <tr>
      <th>10</th>
      <td>JetBlue Airways</td>
      <td>12.222005</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Frontier Airlines Inc.</td>
      <td>11.701328</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ExpressJet Airlines LLC d/b/a aha!</td>
      <td>8.965168</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Spirit Air Lines</td>
      <td>8.090705</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mesa Airlines Inc.</td>
      <td>7.827729</td>
    </tr>
    <tr>
      <th>2</th>
      <td>American Airlines Inc.</td>
      <td>6.474299</td>
    </tr>
    <tr>
      <th>17</th>
      <td>United Air Lines Inc.</td>
      <td>4.777427</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Hawaiian Airlines Inc.</td>
      <td>4.230578</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PSA Airlines Inc.</td>
      <td>4.047381</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="ayKuzQb2xq9r" data-outputId="56254855-ec4a-4466-8543-a0de4e6b57f6">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Delay for Departure Airport (Top 5)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;ORIGIN_CITY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ORIGIN_CITY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>274</th>
      <td>Portsmouth, NH</td>
      <td>74.418605</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Martha's Vineyard, MA</td>
      <td>28.981982</td>
    </tr>
    <tr>
      <th>117</th>
      <td>Fort Dodge, IA</td>
      <td>27.725000</td>
    </tr>
    <tr>
      <th>241</th>
      <td>Newburgh/Poughkeepsie, NY</td>
      <td>27.198473</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Ogdensburg, NY</td>
      <td>26.878788</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="d1mi7IyJ2Blc" data-outputId="c5c847d5-aee7-473d-eca6-393874bdb417">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Delay for Arrival Airport (Top 5)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;DEST_CITY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEST_CITY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>356</th>
      <td>Watertown, NY</td>
      <td>54.333333</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Cold Bay, AK</td>
      <td>44.800000</td>
    </tr>
    <tr>
      <th>333</th>
      <td>Staunton, VA</td>
      <td>35.662338</td>
    </tr>
    <tr>
      <th>281</th>
      <td>Quincy, IL</td>
      <td>32.272727</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Ogdensburg, NY</td>
      <td>23.852459</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="JNPo0JWQ2e9k" data-outputId="2f37513f-8492-487b-b10c-825360af8c5a">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Problematic Routes (Top 5)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;ROUTE&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ROUTE</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5934</th>
      <td>Sanford, FL-Grand Forks, ND</td>
      <td>1736.0</td>
    </tr>
    <tr>
      <th>2308</th>
      <td>Fort Dodge, IA-Denver, CO</td>
      <td>675.0</td>
    </tr>
    <tr>
      <th>2583</th>
      <td>Greer, SC-Tampa, FL</td>
      <td>470.0</td>
    </tr>
    <tr>
      <th>3076</th>
      <td>Kalispell, MT-New York, NY</td>
      <td>384.0</td>
    </tr>
    <tr>
      <th>4798</th>
      <td>Pasco/Kennewick/Richland, WA-San Diego, CA</td>
      <td>266.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="8W-hMu2J21t7" data-outputId="0a34f7b4-0c2b-4a7a-f6f2-69ec0c4f4b88">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay by Year (Top 5)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;YEAR&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>2023</td>
      <td>9.438654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022</td>
      <td>6.794363</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>5.229784</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021</td>
      <td>3.064180</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>-4.897504</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="kfABnbF53PLU" data-outputId="d1a487e5-0c68-41cb-caf8-c6768c71ad87">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay by Month (Top 5)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;MONTH&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>9.935918</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>9.503129</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>6.947276</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>6.460625</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3.615863</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="eV6DdDIw3q3G" data-outputId="333a43fa-38ce-4d6b-935d-f1b7ddaa0e78">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay by Day (Top 5)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;DAY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">5</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>6.113638</td>
    </tr>
    <tr>
      <th>17</th>
      <td>18</td>
      <td>5.943344</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>5.592421</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>5.292069</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>5.061481</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="YUu2D1YA3rAI" data-outputId="1820be85-96de-4608-c4b0-3be7d8c9d129">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay by Day of Week (All Days)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;DAY_OF_WEEK&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>.head(<span class="dv">7</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DAY_OF_WEEK</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5.880224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>5.495350</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>5.274270</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>4.737325</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>3.740388</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2.731811</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1.567949</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:230}"
id="HidL32vV3sLJ" data-outputId="e93aeaa1-210c-466b-d033-7ddfabb6e2dd">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay Time of Day</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>(df.groupby(<span class="st">&#39;TIME_OF_DAY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="35">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME_OF_DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Evening</td>
      <td>14.449354</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afternoon</td>
      <td>4.480773</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Night</td>
      <td>1.777274</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Morning</td>
      <td>-1.911895</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:731}"
id="PfopWzLu5iMd" data-outputId="7762b83a-89e6-4273-d99c-551f58f02b3d">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay (By Year and Time of Day)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>(df.groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TIME_OF_DAY&#39;</span>])[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TIME_OF_DAY&#39;</span>],</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                                            ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>.groupby(<span class="st">&#39;YEAR&#39;</span>).head())</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="36">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>TIME_OF_DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>Evening</td>
      <td>16.019406</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>Afternoon</td>
      <td>5.287369</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>Morning</td>
      <td>-1.519950</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>Night</td>
      <td>3.491146</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020</td>
      <td>Evening</td>
      <td>0.074810</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020</td>
      <td>Afternoon</td>
      <td>-4.745589</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>Morning</td>
      <td>-7.252929</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>Night</td>
      <td>-7.865257</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021</td>
      <td>Evening</td>
      <td>12.910030</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021</td>
      <td>Afternoon</td>
      <td>3.509053</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021</td>
      <td>Morning</td>
      <td>-2.775114</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021</td>
      <td>Night</td>
      <td>0.186633</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2022</td>
      <td>Evening</td>
      <td>17.434419</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2022</td>
      <td>Afternoon</td>
      <td>7.725946</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2022</td>
      <td>Morning</td>
      <td>-0.176289</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2022</td>
      <td>Night</td>
      <td>1.227317</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2023</td>
      <td>Evening</td>
      <td>20.798039</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2023</td>
      <td>Afternoon</td>
      <td>9.749640</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2023</td>
      <td>Morning</td>
      <td>1.736278</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2023</td>
      <td>Night</td>
      <td>7.459995</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:833}"
id="Rjc20M705iO-" data-outputId="e03987d0-b340-44ac-fbe4-49631f149f5a">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Cancelled Flights per Year per Airline</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>(df.groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;AIRLINE&#39;</span>])[<span class="st">&#39;CANCELLED&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>.reset_index(name<span class="op">=</span><span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>.sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>],</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>             ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>.groupby(<span class="st">&#39;YEAR&#39;</span>).head())</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>AIRLINE</th>
      <th>TOTAL_CANCELLED_FLIGHTS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>2019</td>
      <td>Southwest Airlines Co.</td>
      <td>1145</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>American Airlines Inc.</td>
      <td>636</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2019</td>
      <td>SkyWest Airlines Inc.</td>
      <td>526</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019</td>
      <td>Envoy Air</td>
      <td>374</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2019</td>
      <td>Republic Airline</td>
      <td>230</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2020</td>
      <td>Southwest Airlines Co.</td>
      <td>2644</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2020</td>
      <td>American Airlines Inc.</td>
      <td>1193</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2020</td>
      <td>Delta Air Lines Inc.</td>
      <td>1047</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2020</td>
      <td>SkyWest Airlines Inc.</td>
      <td>862</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2020</td>
      <td>United Air Lines Inc.</td>
      <td>755</td>
    </tr>
    <tr>
      <th>48</th>
      <td>2021</td>
      <td>Southwest Airlines Co.</td>
      <td>769</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2021</td>
      <td>American Airlines Inc.</td>
      <td>585</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2021</td>
      <td>SkyWest Airlines Inc.</td>
      <td>458</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2021</td>
      <td>Republic Airline</td>
      <td>206</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2021</td>
      <td>United Air Lines Inc.</td>
      <td>204</td>
    </tr>
    <tr>
      <th>65</th>
      <td>2022</td>
      <td>Southwest Airlines Co.</td>
      <td>1426</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2022</td>
      <td>American Airlines Inc.</td>
      <td>863</td>
    </tr>
    <tr>
      <th>63</th>
      <td>2022</td>
      <td>Republic Airline</td>
      <td>472</td>
    </tr>
    <tr>
      <th>64</th>
      <td>2022</td>
      <td>SkyWest Airlines Inc.</td>
      <td>468</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2022</td>
      <td>Delta Air Lines Inc.</td>
      <td>466</td>
    </tr>
    <tr>
      <th>80</th>
      <td>2023</td>
      <td>Southwest Airlines Co.</td>
      <td>418</td>
    </tr>
    <tr>
      <th>71</th>
      <td>2023</td>
      <td>Delta Air Lines Inc.</td>
      <td>326</td>
    </tr>
    <tr>
      <th>82</th>
      <td>2023</td>
      <td>United Air Lines Inc.</td>
      <td>318</td>
    </tr>
    <tr>
      <th>70</th>
      <td>2023</td>
      <td>American Airlines Inc.</td>
      <td>301</td>
    </tr>
    <tr>
      <th>78</th>
      <td>2023</td>
      <td>Republic Airline</td>
      <td>231</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown" id="h4yS9_KB9n6I">
<p>Now it's time to write the loop and incorporate all the chunks in
chunker so we can get aggregate results and concatenate them.</p>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Ry16Rw5A9Ann" data-outputId="a5ed982e-2892-4c3f-f2e0-d7d4bfbdb58c">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the necessarry lists according to the previous Analysis</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>mean_del_air <span class="op">=</span> [] <span class="co">#Mean Delay per Airline</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>most_del_dep <span class="op">=</span> [] <span class="co">#Most Delay for Departure Airport</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>most_del_arr <span class="op">=</span> [] <span class="co">#Most Delay for Arrival Airport</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>most_prob_route <span class="op">=</span> [] <span class="co">#Most Problematic Routes</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>mean_del_year <span class="op">=</span> [] <span class="co">#Mean Delay by Year</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>mean_del_month <span class="op">=</span> [] <span class="co">#Mean Delay by Month</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>mean_del_day <span class="op">=</span> [] <span class="co">#Mean Delay by Day</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>mean_del_dow <span class="op">=</span>[] <span class="co">#Mean Delay by Day of Week</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>mean_del_tod <span class="op">=</span> [] <span class="co">#Mean Delay Time of Day</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>mean_del_ytod <span class="op">=</span> [] <span class="co">#Mean Delay (By Year and Time of Day)</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>mean_can_ya <span class="op">=</span> [] <span class="co">#Most Cancelled Flights Per Year per Airline</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Reloading the dataset and making the chunker</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>chunker<span class="op">=</span>pd.read_csv(path, chunksize<span class="op">=</span><span class="dv">1000000</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating the Loop</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chunk <span class="kw">in</span> chunker:</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  chunk<span class="op">=</span>clean_chunk(chunk) <span class="co">#Cleaning Function</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  chunk<span class="op">=</span>feature_chunker(chunk) <span class="co">#Feature Engineering</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Performing GroupBy Statistics</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay per Airline (Top 10)</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  mean_del_air_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;AIRLINE&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>                                              ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>                                              .head(<span class="dv">10</span>))</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  mean_del_air.append(mean_del_air_chunk)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Delay for Departure Airport (Top 5)</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  most_del_dep_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;ORIGIN_CITY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>  most_del_dep.append(most_del_dep_chunk)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Delay for Arrival Airport (Top 5)</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  most_del_arr_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;DEST_CITY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  most_del_arr.append(most_del_arr_chunk)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Problematic Routes (Top 5)</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  most_prob_route_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;ROUTE&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  most_prob_route.append(most_prob_route_chunk)</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay by Year (Top 5)</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  mean_del_year_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;YEAR&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  mean_del_year.append(mean_del_year_chunk)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay by Month (Top 5)</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  mean_del_month_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;MONTH&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>  mean_del_month.append(mean_del_month_chunk)</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay by Day (Top 5)</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>  mean_del_day_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;DAY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">5</span>))</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>  mean_del_day.append(mean_del_day_chunk)</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay by Day of Week (All Days)</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>  mean_del_dow_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;DAY_OF_WEEK&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>  .head(<span class="dv">7</span>))</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>  mean_del_dow.append(mean_del_dow_chunk)</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay Time of Day</span></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>  mean_del_tod_chunk <span class="op">=</span> (chunk.groupby(<span class="st">&#39;TIME_OF_DAY&#39;</span>)[<span class="st">&#39;ARR_DELAY&#39;</span>].mean()</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>  mean_del_tod.append(mean_del_tod_chunk)</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean Delay (By Year and Time of Day)</span></span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>  mean_del_ytod_chunk <span class="op">=</span> (chunk.groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TIME_OF_DAY&#39;</span>])[<span class="st">&#39;ARR_DELAY&#39;</span>]</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>                         .mean()</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>).sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TIME_OF_DAY&#39;</span>],</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>                                            ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">&#39;YEAR&#39;</span>).head())</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>  mean_del_ytod.append(mean_del_ytod_chunk)</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Cancelled Flights per Year per Airline</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>  mean_can_ya_chunk <span class="op">=</span> (chunk.groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;AIRLINE&#39;</span>])[<span class="st">&#39;CANCELLED&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>  .reset_index(name<span class="op">=</span><span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>)</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>  .sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>  .groupby(<span class="st">&#39;YEAR&#39;</span>).head())</span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>  mean_can_ya.append(mean_can_ya_chunk)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value &#39;nan&#39; has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>CPU times: user 28.1 s, sys: 3.2 s, total: 31.3 s
Wall time: 31.5 s
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="39" id="_g7P4lQ_qpNJ">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Concat the DataFrames</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mean_del_air <span class="op">=</span> pd.concat(mean_del_air,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>most_del_dep <span class="op">=</span> pd.concat(most_del_dep,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>most_del_arr <span class="op">=</span> pd.concat(most_del_arr,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>most_prob_route <span class="op">=</span> pd.concat(most_prob_route,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>mean_del_year <span class="op">=</span> pd.concat(mean_del_year,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>mean_del_month <span class="op">=</span> pd.concat(mean_del_month,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>mean_del_day <span class="op">=</span> pd.concat(mean_del_day,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>mean_del_dow <span class="op">=</span> pd.concat(mean_del_dow,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>mean_del_tod <span class="op">=</span> pd.concat(mean_del_tod,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>mean_del_ytod <span class="op">=</span> pd.concat(mean_del_ytod,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>mean_can_ya <span class="op">=</span> pd.concat(mean_can_ya,ignore_index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="Wp3Q9vu8umkh">
<p><strong>Final Results from all Dataset</strong></p>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:394}"
id="rKzEism5sRQR" data-outputId="a35f11d7-6ca0-45fd-fe77-3c81c16c6b2f">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Airline</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>mean_del_air <span class="op">=</span> (mean_del_air.groupby(<span class="st">&#39;AIRLINE&#39;</span>).mean().reset_index()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>mean_del_air</span></code></pre></div>
<div class="output execute_result" data-execution_count="40">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIRLINE</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Allegiant Air</td>
      <td>13.284564</td>
    </tr>
    <tr>
      <th>5</th>
      <td>JetBlue Airways</td>
      <td>12.275169</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Frontier Airlines Inc.</td>
      <td>11.099075</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ExpressJet Airlines LLC d/b/a aha!</td>
      <td>10.036477</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Spirit Air Lines</td>
      <td>8.029335</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mesa Airlines Inc.</td>
      <td>7.309973</td>
    </tr>
    <tr>
      <th>1</th>
      <td>American Airlines Inc.</td>
      <td>6.661128</td>
    </tr>
    <tr>
      <th>10</th>
      <td>United Air Lines Inc.</td>
      <td>5.035776</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hawaiian Airlines Inc.</td>
      <td>4.230578</td>
    </tr>
    <tr>
      <th>8</th>
      <td>SkyWest Airlines Inc.</td>
      <td>4.112953</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PSA Airlines Inc.</td>
      <td>3.928943</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="kI7j3T0LvPCh" data-outputId="9079042a-b3db-43bd-dad3-4e3101600f6c">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Biggest Mean Arrival Delay per Departure City (Top 10)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>most_del_dep<span class="op">=</span>(most_del_dep.groupby(<span class="st">&#39;ORIGIN_CITY&#39;</span>).mean().reset_index()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>               .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)).head(<span class="dv">10</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>most_del_dep</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ORIGIN_CITY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Pago Pago, TT</td>
      <td>167.600000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Portsmouth, NH</td>
      <td>74.418605</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Santa Maria, CA</td>
      <td>52.858929</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hagerstown, MD</td>
      <td>45.187500</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Moab, UT</td>
      <td>40.152174</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Riverton/Lander, WY</td>
      <td>39.684211</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hattiesburg/Laurel, MS</td>
      <td>35.889908</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Alamosa, CO</td>
      <td>35.466667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Greenville, NC</td>
      <td>34.555556</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hyannis, MA</td>
      <td>34.454545</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="6qSkevICsnr5" data-outputId="4c5ac968-322a-4388-b76b-79a59128f046">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Biggest Mean Arrival Delay per Arrival City (Top 10)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>most_del_arr <span class="op">=</span> (most_del_arr.groupby(<span class="st">&#39;DEST_CITY&#39;</span>).mean().reset_index()</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>               .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)).head(<span class="dv">10</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>most_del_arr</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEST_CITY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Williamsport, PA</td>
      <td>104.375000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Watertown, NY</td>
      <td>54.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cold Bay, AK</td>
      <td>44.800000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Provo, UT</td>
      <td>43.270440</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Wilmington, DE</td>
      <td>37.250000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dickinson, ND</td>
      <td>34.423077</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Cheyenne, WY</td>
      <td>32.355932</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Quincy, IL</td>
      <td>31.072391</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Staunton, VA</td>
      <td>30.428665</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ogdensburg, NY</td>
      <td>25.819087</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="JgGvai4Ny3tF" data-outputId="0bd3ad31-a644-4e3e-b12d-9602e31b1650">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Problematic Routes</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>most_prob_route <span class="op">=</span> (most_prob_route.groupby(<span class="st">&#39;ROUTE&#39;</span>).mean().reset_index()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                  .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)).head(<span class="dv">10</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>most_prob_route</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ROUTE</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Sanford, FL-Grand Forks, ND</td>
      <td>1736.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denver, CO-Allentown/Bethlehem/Easton, PA</td>
      <td>1080.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>St. Petersburg, FL-Provo, UT</td>
      <td>760.500000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Miami, FL-Huntsville, AL</td>
      <td>677.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Fort Dodge, IA-Denver, CO</td>
      <td>675.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Idaho Falls, ID-Portland, OR</td>
      <td>512.333333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Greer, SC-Tampa, FL</td>
      <td>470.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Provo, UT-St. Petersburg, FL</td>
      <td>430.800000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Savannah, GA-Akron, OH</td>
      <td>414.750000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kalispell, MT-New York, NY</td>
      <td>384.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="gY4N_vtsy3vU" data-outputId="e263e988-79d3-4b6c-efcc-adff0133b5f8">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay Per Year</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>mean_del_year <span class="op">=</span> (mean_del_year.groupby(<span class="st">&#39;YEAR&#39;</span>).mean().reset_index()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                 .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>mean_del_year</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>2023</td>
      <td>9.365190</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022</td>
      <td>6.912811</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>5.309118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021</td>
      <td>3.096834</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>-5.010135</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="w_Bv6Jhjy3x0" data-outputId="64c4a1ca-0023-4108-aaf3-8c88a113f864">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Month (Top 5)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>mean_del_month <span class="op">=</span> (mean_del_month.groupby(<span class="st">&#39;MONTH&#39;</span>).mean().reset_index()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                  .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>mean_del_month</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>10.061934</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>9.490894</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>6.671897</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>6.453062</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>3.712331</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="xfXXpy6n1JTi" data-outputId="d4034ad7-acae-4e3d-9a99-250bf4317247">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Day of Month (Top 5 Days)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mean_del_day <span class="op">=</span> (mean_del_day.groupby(<span class="st">&#39;DAY&#39;</span>).mean().reset_index()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                 .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)).head(<span class="dv">5</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>mean_del_day</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>6.395350</td>
    </tr>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>5.941047</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>5.476373</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>5.330455</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>5.325991</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="8bRdP1I31NvC" data-outputId="ec3be259-b7dd-4f03-c322-abeed601fa36">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Day of Week</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>mean_del_dow <span class="op">=</span> (mean_del_dow.groupby(<span class="st">&#39;DAY_OF_WEEK&#39;</span>).mean().reset_index()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>mean_del_dow</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DAY_OF_WEEK</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5.946944</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>5.563607</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>5.291305</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>4.717739</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>3.669640</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2.632080</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1.693053</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:230}"
id="B4nbs72710b6" data-outputId="c3f2ac30-d060-4ed4-e0cf-130b765b63dd">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time of Day (Delay)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mean_del_tod <span class="op">=</span> (mean_del_tod.groupby(<span class="st">&#39;TIME_OF_DAY&#39;</span>).mean().reset_index()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                .sort_values(by<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>mean_del_tod</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="48">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME_OF_DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Evening</td>
      <td>14.459800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afternoon</td>
      <td>4.519609</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Night</td>
      <td>1.881116</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Morning</td>
      <td>-1.921206</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:731}"
id="GrNFhTBj2ljS" data-outputId="e40cc403-992d-459e-d455-8cf5a28b799a">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Deleay per Year per Time of Day</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>mean_del_ytod <span class="op">=</span> (mean_del_ytod.groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TIME_OF_DAY&#39;</span>])[<span class="st">&#39;MEAN_DELAY&#39;</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                .mean().reset_index().sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;MEAN_DELAY&#39;</span>],</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                                                  ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>]))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>mean_del_ytod</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.12/dist-packages/cudf/pandas/fast_slow_proxy.py:28: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  return fn(*args, **kwargs)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="49">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>TIME_OF_DAY</th>
      <th>MEAN_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>Evening</td>
      <td>16.083502</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>Afternoon</td>
      <td>5.472038</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>Night</td>
      <td>3.229411</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>Morning</td>
      <td>-1.520423</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020</td>
      <td>Evening</td>
      <td>-0.588492</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020</td>
      <td>Afternoon</td>
      <td>-4.704525</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>Morning</td>
      <td>-7.250626</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>Night</td>
      <td>-7.929478</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021</td>
      <td>Evening</td>
      <td>12.923390</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021</td>
      <td>Afternoon</td>
      <td>3.290214</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021</td>
      <td>Night</td>
      <td>1.078260</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021</td>
      <td>Morning</td>
      <td>-2.566810</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2022</td>
      <td>Evening</td>
      <td>17.453823</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2022</td>
      <td>Afternoon</td>
      <td>7.863868</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2022</td>
      <td>Night</td>
      <td>1.988361</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2022</td>
      <td>Morning</td>
      <td>-0.065398</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2023</td>
      <td>Evening</td>
      <td>21.400504</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2023</td>
      <td>Afternoon</td>
      <td>9.798909</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2023</td>
      <td>Night</td>
      <td>6.605788</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2023</td>
      <td>Morning</td>
      <td>1.256268</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:927}"
id="2vFe3oNJ6_L-" data-outputId="d4a811fc-ee7a-47f2-9d7c-ab3c93c02eca">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most cancelled flights per Airline per Year</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mean_can_ya <span class="op">=</span> (mean_can_ya</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>               .groupby([<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;AIRLINE&#39;</span>])[<span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>               .reset_index().sort_values(by<span class="op">=</span>[<span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>],</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                                          ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>               .reset_index(drop<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>mean_can_ya</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>AIRLINE</th>
      <th>TOTAL_CANCELLED_FLIGHTS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>Southwest Airlines Co.</td>
      <td>3389</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>American Airlines Inc.</td>
      <td>1955</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>SkyWest Airlines Inc.</td>
      <td>1672</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>Envoy Air</td>
      <td>1072</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>Republic Airline</td>
      <td>736</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>Southwest Airlines Co.</td>
      <td>8056</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020</td>
      <td>American Airlines Inc.</td>
      <td>3538</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020</td>
      <td>Delta Air Lines Inc.</td>
      <td>2951</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020</td>
      <td>SkyWest Airlines Inc.</td>
      <td>2545</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020</td>
      <td>United Air Lines Inc.</td>
      <td>2254</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021</td>
      <td>Southwest Airlines Co.</td>
      <td>2376</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021</td>
      <td>American Airlines Inc.</td>
      <td>1696</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021</td>
      <td>SkyWest Airlines Inc.</td>
      <td>1321</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2021</td>
      <td>Republic Airline</td>
      <td>416</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2021</td>
      <td>United Air Lines Inc.</td>
      <td>396</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021</td>
      <td>Spirit Air Lines</td>
      <td>196</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2021</td>
      <td>Envoy Air</td>
      <td>190</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2022</td>
      <td>Southwest Airlines Co.</td>
      <td>4310</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2022</td>
      <td>American Airlines Inc.</td>
      <td>2563</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2022</td>
      <td>Republic Airline</td>
      <td>1469</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2022</td>
      <td>Delta Air Lines Inc.</td>
      <td>1443</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2022</td>
      <td>SkyWest Airlines Inc.</td>
      <td>1330</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2023</td>
      <td>Southwest Airlines Co.</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2023</td>
      <td>Delta Air Lines Inc.</td>
      <td>954</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2023</td>
      <td>American Airlines Inc.</td>
      <td>913</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2023</td>
      <td>United Air Lines Inc.</td>
      <td>893</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2023</td>
      <td>SkyWest Airlines Inc.</td>
      <td>485</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2023</td>
      <td>Republic Airline</td>
      <td>231</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown" id="KYREWBzO-2jY">
<p>##<strong>Step 6: Visualization</strong> At this step we will
visualize all the preceding results with barplots. Further analysis
about the sample distribution, skewness and curtosis can be computed,
however this is outside of the scope of this EDA.</p>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="PD6S7i867AcK" data-outputId="74ded0f3-8171-42a7-c811-d1049e0fb458">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Top 10 Airlines with most delay</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_air, x<span class="op">=</span><span class="st">&#39;AIRLINE&#39;</span>, y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>, width<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">2</span>,<span class="dv">14</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Top 10 Airlines with most delay&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Airlines&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">&#39;Allegiant Air&#39;</span>,<span class="st">&#39;JetBlue Airways&#39;</span>,<span class="st">&#39;Frontier Airlines Inc.&#39;</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;ExpressJet Airlines </span><span class="ch">\n</span><span class="st">LLC d/b/a aha!&#39;</span>,	<span class="st">&#39;Spirit Air Lines&#39;</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Mesa Airlines Inc.&#39;</span>,<span class="st">&#39;American Airlines Inc.&#39;</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;United Air Lines Inc.&#39;</span>,<span class="st">&#39;Hawaiian Airlines Inc.&#39;</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;SkyWest Airlines Inc.&#39;</span>,<span class="st">&#39;PSA Airlines Inc.&#39;</span>], fontsize<span class="op">=</span><span class="dv">9</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2671193904.py:10: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([&#39;Allegiant Air&#39;,&#39;JetBlue Airways&#39;,&#39;Frontier Airlines Inc.&#39;,
</code></pre>
</div>
<div class="output execute_result" data-execution_count="51">
<pre><code>[Text(0, 0, &#39;Allegiant Air&#39;),
 Text(1, 0, &#39;JetBlue Airways&#39;),
 Text(2, 0, &#39;Frontier Airlines Inc.&#39;),
 Text(3, 0, &#39;ExpressJet Airlines \nLLC d/b/a aha!&#39;),
 Text(4, 0, &#39;Spirit Air Lines&#39;),
 Text(5, 0, &#39;Mesa Airlines Inc.&#39;),
 Text(6, 0, &#39;American Airlines Inc.&#39;),
 Text(7, 0, &#39;United Air Lines Inc.&#39;),
 Text(8, 0, &#39;Hawaiian Airlines Inc.&#39;),
 Text(9, 0, &#39;SkyWest Airlines Inc.&#39;),
 Text(10, 0, &#39;PSA Airlines Inc.&#39;)]</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/a1cac4b09a045ae0ad19b38a22723fb421a6db13.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="52"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="-Cg9rIuKDaKt" data-outputId="eb20d23b-3ab2-493e-da3b-85f7724ff191">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Biggest Mean Arrival Delay per Departure City (Top 10) &amp;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Biggest Mean Arrival Delay per Arrival City (Top 10)</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">19</span>,<span class="dv">20</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>ax2<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>most_del_dep,x<span class="op">=</span><span class="st">&#39;ORIGIN_CITY&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax1,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>most_del_arr,x<span class="op">=</span><span class="st">&#39;DEST_CITY&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax2,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Top 10 Departure Cities with most Delay&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Top 10 Arrival Cities with most Delay&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Departure Cities&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Arrival Cities&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(ax1.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(ax2.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">20</span>,<span class="dv">170</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">20</span>,<span class="dv">110</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-10645453.py:15: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax1.set_xticklabels(ax1.get_xticklabels(),fontsize=9)
/tmp/ipython-input-10645453.py:16: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax2.set_xticklabels(ax2.get_xticklabels(),fontsize=9)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="52">
<pre><code>(20.0, 110.0)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/abd36e4c792095cfd43a4cf39c81e7ade52a6f81.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="53"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="bgh0wZI1EXjO" data-outputId="0eaf6947-150e-4e61-814d-b0266a5699e5">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Problematic Routes</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>most_prob_route,x<span class="op">=</span><span class="st">&#39;ROUTE&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Most Problematic Routes&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Routes&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">200</span>,<span class="dv">1750</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">&#39;Sanford, FL-</span><span class="ch">\n</span><span class="st">Grand Forks, ND&#39;</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Denver, CO-</span><span class="ch">\n</span><span class="st">Allentown/Bethlehem/Easton, PA&#39;</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;St. Petersburg, FL-</span><span class="ch">\n</span><span class="st">Provo, UT&#39;</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Miami, FL-</span><span class="ch">\n</span><span class="st">Huntsville, AL&#39;</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Fort Dodge, IA-</span><span class="ch">\n</span><span class="st">Denver, CO&#39;</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Idaho Falls, ID-</span><span class="ch">\n</span><span class="st">Portland, OR&#39;</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Greer, SC-</span><span class="ch">\n</span><span class="st">Tampa, FL&#39;</span>,</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Provo, UT-</span><span class="ch">\n</span><span class="st">St. Petersburg, FL&#39;</span>,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>	                  <span class="st">&#39;Savannah, GA-</span><span class="ch">\n</span><span class="st">Akron, OH&#39;</span>,</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Kalispell, MT-</span><span class="ch">\n</span><span class="st">New York, NY&#39;</span>],fontsize<span class="op">=</span><span class="dv">8</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3542132368.py:10: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([&#39;Sanford, FL-\nGrand Forks, ND&#39;,
</code></pre>
</div>
<div class="output execute_result" data-execution_count="53">
<pre><code>[Text(0, 0, &#39;Sanford, FL-\nGrand Forks, ND&#39;),
 Text(1, 0, &#39;Denver, CO-\nAllentown/Bethlehem/Easton, PA&#39;),
 Text(2, 0, &#39;St. Petersburg, FL-\nProvo, UT&#39;),
 Text(3, 0, &#39;Miami, FL-\nHuntsville, AL&#39;),
 Text(4, 0, &#39;Fort Dodge, IA-\nDenver, CO&#39;),
 Text(5, 0, &#39;Idaho Falls, ID-\nPortland, OR&#39;),
 Text(6, 0, &#39;Greer, SC-\nTampa, FL&#39;),
 Text(7, 0, &#39;Provo, UT-\nSt. Petersburg, FL&#39;),
 Text(8, 0, &#39;Savannah, GA-\nAkron, OH&#39;),
 Text(9, 0, &#39;Kalispell, MT-\nNew York, NY&#39;)]</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/df1cd54805c06929529a900c2f3a032c9ddccea7.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="Rm-Ldk8_KDRz" data-outputId="48ba86eb-0840-4134-df7c-0e53b85afa28">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Delay by Time</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting up axes</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">17</span>))</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>ax2<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>ax3<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>ax4<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>ax5<span class="op">=</span>fig.add_subplot(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Subplots</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_year,x<span class="op">=</span><span class="st">&#39;YEAR&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax1,width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_month,x<span class="op">=</span><span class="st">&#39;MONTH&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax2,width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_day,x<span class="op">=</span><span class="st">&#39;DAY&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax3,width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_dow,x<span class="op">=</span><span class="st">&#39;DAY_OF_WEEK&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax4,width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_tod,x<span class="op">=</span><span class="st">&#39;TIME_OF_DAY&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,ax<span class="op">=</span>ax5,width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Customizing Text</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Year&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Month&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Day of Month&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">&#39;Day of Week&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>ax5.set_xlabel(<span class="st">&#39;Time of Day&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>ax5.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Mean Delay by Year&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Mean Delay by Month&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Mean Delay by Day of Month&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">&#39;Mean Delay by Day of Week&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>ax5.set_title(<span class="st">&#39;Mean Delay by Time of Day&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Delay Analysis&#39;</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Customizing axxes</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>ax2.set_ylim(<span class="dv">2</span>,<span class="dv">10</span>)</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">4</span>,<span class="fl">6.5</span>)</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>ax4.set_ylim(<span class="dv">1</span>,<span class="dv">7</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>ax4.set_xticklabels([<span class="st">&#39;Mon&#39;</span>,<span class="st">&#39;Tue&#39;</span>,<span class="st">&#39;Wed&#39;</span>,<span class="st">&#39;Thur&#39;</span>,<span class="st">&#39;Fri&#39;</span>,<span class="st">&#39;Sat&#39;</span>,<span class="st">&#39;Sun&#39;</span>])</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>ax5.set_position([<span class="fl">0.25</span>,<span class="fl">0.05</span>,<span class="fl">0.45</span>,<span class="fl">0.28</span>])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-233107511.py:42: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax4.set_xticklabels([&#39;Mon&#39;,&#39;Tue&#39;,&#39;Wed&#39;,&#39;Thur&#39;,&#39;Fri&#39;,&#39;Sat&#39;,&#39;Sun&#39;])
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/3d2c24baef696945a4a83a70721d923f02a7f36e.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:880}"
id="-cR06sKYQiDn" data-outputId="58927736-aae7-4865-b5aa-1cfc5f939054">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean Delay per Year per Time of Day</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">10</span>))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_del_ytod,x<span class="op">=</span><span class="st">&#39;YEAR&#39;</span>,y<span class="op">=</span><span class="st">&#39;MEAN_DELAY&#39;</span>,hue<span class="op">=</span><span class="st">&#39;TIME_OF_DAY&#39;</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax,width<span class="op">=</span><span class="fl">0.6</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Mean Delay per Year per Time of Day&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Year&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Mean Delay (Minutes)&#39;</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="op">-</span><span class="dv">8</span>,<span class="dv">21</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>ax.grid()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/f9af99f0d0874c744d9d7b79d5d78861f4027b87.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:973}"
id="V-R7yDxma7uv" data-outputId="edc769e5-a3ac-4333-e0d6-877b2914eeba">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Total cancelled flights per Airline per Year</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">11</span>))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>mean_can_ya,x<span class="op">=</span><span class="st">&#39;YEAR&#39;</span>,y<span class="op">=</span><span class="st">&#39;TOTAL_CANCELLED_FLIGHTS&#39;</span>,hue<span class="op">=</span><span class="st">&#39;AIRLINE&#39;</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax,width<span class="op">=</span><span class="fl">0.8</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Total Cancelled Flights per Airline per Year&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Year&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Total Cancelled Flights&#39;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="66">
<pre><code>Text(0, 0.5, &#39;Total Cancelled Flights&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3700fe64ed1d44a0aa81b1e5783ddcfc/bb3dab3e02a55bbc66eacc6c0f092d57d3784bc9.png" /></p>
</div>
</div>
<div class="cell markdown" id="maVuqMVcnBqe">
<p>##<strong>Step 7: Conclusion</strong> Through this explorary data
analysis we examined the behaviour of delay (more specifically the
<code>ARR_DELAY</code>) across years 2019-2023 from a sample of 2.9
million flights. Furthermore we examined the behaviour of total
cancelled flight per Year per Airline, more specifically the top 5 each
year.</p>
<p><strong>Key Findings</strong></p>
<ul>
<li><p>The Airlines (top 3) with most delay are by the following
order:</p>
<ol>
<li>Allegiant Air</li>
<li>JetBlue</li>
<li>Frontier Airlines</li>
</ol></li>
<li><p>The most delay to reach any destination (Top 3) is found if you
depart in one of the following cities:</p>
<ol>
<li>Pago Pago (TT)</li>
<li>Portsmouth (NH)</li>
<li>Santa Maria (CA)</li>
</ol></li>
<li><p>The destinations that are the most problematic (Top 3), departing
from anywhere are:</p>
<ol>
<li>Williamsport (PA)</li>
<li>Watertown (NY)<br />
</li>
<li>Coldbay (AK)</li>
</ol></li>
<li><p>Delay was negative at 2020 due, which means aircrafts were
arriving faster than expected (due to covid), however from 2021 it is
constantly increasing.</p></li>
<li><p>The months with the most delay (Top 3) are:</p>
<ol>
<li>June</li>
<li>July</li>
<li>December</li>
</ol></li>
<li><p>Analysis showed that in every month the most delay occurs at the
second 10-day window (11-20 of each month)</p></li>
<li><p>The day which has the most delay is Friday and the time of day
which max delay is evening (18:00-00:00)</p></li>
<li><p>There is a decreasing tedency of cancelled flights of Southwest,
American and Skywest whhich also have have the most cancelled flights
per year.</p></li>
</ul>
</div>
</body>
</html>
